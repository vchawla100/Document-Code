SELECT winame,
       'LEA' AS ModuleID,
       'A' AS TXNTYPE,
       'LS' AS BPTYPE,
       '0' AS DEFCHARGERATE,
       '0' AS DEFCHARGEAMT,
       CASE
           WHEN NewRowNum = 1 THEN '0'
           WHEN NewRowNum = 2 THEN '0'
           WHEN NewRowNum = 3 THEN '%'
       END AS ChargeRate,
       CASE
           WHEN NewRowNum = 1 THEN LoanAmount
           WHEN NewRowNum = 2 THEN InterestRate
           WHEN NewRowNum = 3 THEN ProcessingFee
       END AS ChargeAmt,
       'N' AS AdviceGenFlag,
       'N' AS ADVICE,
       'A' AS Status,
       CASE
           WHEN NewRowNum = 1 THEN 'P'
           WHEN NewRowNum = 2 THEN 'R'
           WHEN NewRowNum = 3 THEN 'R'
       END AS RCPTPMNTFLG,
       CASE
           WHEN NewRowNum = 1 THEN '2'
           WHEN NewRowNum = 2 THEN '19'
           WHEN NewRowNum = 3 THEN '35'
       END AS CHARGECODEID,
       CASE
           WHEN NewRowNum = 1 THEN 'Loan Disbursed'
           WHEN NewRowNum = 2 THEN 'Finance Charges'
           WHEN NewRowNum = 3 THEN 'Loan Processing Fee'
       END AS CHARGEDESC,
       'AED' AS CurrencyID,
       '24' AS PRODUCTID,
       '8' AS BRANCHID,
       SUBSTRING(winame, 11, 10) AS NewgenAppID,
       CONVERT(NVARCHAR, GETDATE(), 6) AS CurrentDate
FROM (
    SELECT 
        winame, 
        LoanAmount,
		InterestRate,
		ProcessingFee,
        ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS NewRowNum
    FROM 
        NG_DPL_EXTTABLE
) AS NumberedRecords
WHERE winame = 'DigitalPL-0034';
